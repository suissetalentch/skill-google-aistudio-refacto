# google-aistudio-refacto

Refactor React/TypeScript frontend code generated by Google AI Studio to production-grade conventions. Detects and fixes 20 systematic anti-patterns with an automated scan-fix-verify loop.

## Installation

Add this skill to your Claude Code setup:

- **Personal:** `~/.claude/skills/google-aistudio-refacto/`
- **Project:** `.claude/skills/google-aistudio-refacto/`
- **Plugin:** Add to your `plugin.json`

## Usage

### Standard mode — guided refactoring

```
/google-aistudio-refacto ./path/to/ai-studio-project
```

### Scan only — detect anti-patterns without fixing

```
/google-aistudio-refacto --scan ./path/to/project
```

### Ralph mode — autonomous loop until all P0+P1 anti-patterns are fixed

```
/google-aistudio-refacto --ralph ./path/to/project
```

Ralph mode iterates autonomously: scan → fix highest-priority → build check → commit → rescan. Stops when all P0+P1 anti-patterns are resolved, or after 15 iterations.

Claude can also trigger this skill automatically when it detects AI Studio patterns (Tailwind CDN, ESM import maps, `metadata.json`, `React.FC`, `export default`, exposed API keys).

## How It Works

```
┌──────────┐    ┌──────────┐    ┌──────────┐
│  SCAN    │───>│   FIX    │───>│  BUILD   │──┐
│  20 anti │    │  Top P0  │    │  tsc +   │  │
│  patterns│    │  first   │    │  vite    │  │
└──────────┘    └──────────┘    └──────────┘  │
     ^                                        │
     │         anti-patterns > 0?             │
     └────────────────────────────────────────┘
```

Each iteration:
1. Scans for all 20 anti-patterns using Grep/Glob
2. Picks the highest-priority remaining issue (P0 > P1 > P2 > P3)
3. Reads the corresponding guide and applies the fix
4. Verifies with `npx tsc --noEmit` and `npm run build`
5. Commits the fix and re-scans

## What It Fixes

| # | Category | Anti-patterns |
|---|----------|--------------|
| P0 | **Build** | Tailwind CDN, ESM.sh import maps, metadata.json artifact |
| P0 | **Structure** | Flat root, no barrel exports, no feature folders |
| P0 | **Security** | API key in client bundle, prompts mixed in code |
| P1 | **TypeScript** | `React.FC`, no strict mode, `catch (err: any)`, unnecessary `import React` |
| P1 | **Assets** | Inline SVGs instead of Lucide React |
| P1 | **Quality** | No ErrorBoundary, unsafe JSON.parse |
| P2 | **i18n** | Hardcoded French strings, no i18next |
| P2 | **Performance** | No lazy loading, no code splitting, no manualChunks |
| P3 | **State** | Prop drilling, all state in App component |
| P3 | **Forms** | Raw useState, hardcoded personal data, no Zod validation |

## Reference Projects

Conventions are based on three production codebases:

- **DahuAdmin** — CRM (React + Vite + TailwindCSS + Zustand)
- **place2work** — Job platform (React + Vite + TailwindCSS + i18next)
- **font-dahu** — Marketing site (React + Vite + TailwindCSS + i18next + lazy loading)

## Documentation

| Guide | What it covers |
|-------|---------------|
| [01-project-structure](docs/01-project-structure.md) | Flat root → feature-based src/ |
| [02-tailwind-config](docs/02-tailwind-config.md) | CDN → build-time + cn() utility |
| [03-typescript-strict](docs/03-typescript-strict.md) | strict: true, no React.FC |
| [04-i18n-setup](docs/04-i18n-setup.md) | i18next with namespaces |
| [05-state-management](docs/05-state-management.md) | Zustand / Context / React Query |
| [06-api-services](docs/06-api-services.md) | API key security + service layer |
| [07-icons-and-assets](docs/07-icons-and-assets.md) | Inline SVG → Lucide React |
| [08-performance](docs/08-performance.md) | Lazy loading + Vite chunks |
| [09-forms-validation](docs/09-forms-validation.md) | React Hook Form + Zod |
| [10-code-quality](docs/10-code-quality.md) | ErrorBoundary + safe parsing |

## Allowed Tools

Read, Write, Edit, Bash, Grep, Glob
